---
title: "EDA"
author: "James A. Coppock, Cyrus Tanade, Nicole Zimmer"
date: "9/25/2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## BME 590: Fall Detection

```{r cars}
setwd("~/Desktop/Duke/Class/Fall 2020/Biomedical DS/BME590_Fall_Detection")
library("tidyverse")
library(readxl)
library(evobiR)
library(patchwork)
library(gridExtra)
Falls_df <- read_excel('Fall_Data.xlsx')
```

## Including Plots

You can also embed plots, for example:

```{r , echo=FALSE}
cat('The Number of Falls in this Set of Data is:',(sum(Falls_df$Target)))
Fs <- 100
win <- 2
stp <- 0.5
window <-win*Fs
step <- stp*Fs 
Targets<-SlidingWindow("max", Falls_df$Target, window, step)
maxAccX<-SlidingWindow("max", abs(Falls_df$accX), window, step)
maxAccY<-SlidingWindow("max", abs(Falls_df$accY), window, step)
maxAccZ<-SlidingWindow("max", abs(Falls_df$accZ), window, step)
Features<-data.frame(cbind(maxAccX,maxAccY,maxAccZ))

```

```{r , echo=FALSE}
time<-seq(from = 1/Fs, to =(length(Falls_df$accX)/Fs) , by = 1/Fs)
wintime<-seq(from = 1/100, to =(length(Features$maxAccX)/2) , by = 1/2)


p1<-ggplot(data=Falls_df, aes(x = time, y=accX, group=1)) +
  geom_line(linetype = "solid") + labs(title = "X Acceleration") 

p2<-ggplot(data=Features, aes(x = wintime, y=maxAccX, group=1)) +
  geom_line(linetype = "solid") + labs(title = "Max X Acceleration in (2:0.5) Window") 

p1+ p2
```

```{r}
yhat<-as.logical(Falls_df$Target)
fX<-Falls_df$accX[yhat]
fY<-Falls_df$accY[yhat]
fZ<-Falls_df$accZ[yhat]
X<-time[yhat]
feat<-data.frame(cbind(X,fX,fY,fZ))
p1<-ggplot(data=Falls_df, aes(x = time, y=accX, group=1)) +
  geom_line(linetype = "solid") + labs(title = "X Acceleration") + geom_point(data=feat, aes(x = X, y=fX, group=2,color = 'Falls'))
p2<-ggplot(data=Falls_df, aes(x = time, y=accY, group=1)) +
  geom_line(linetype = "solid") + labs(title = "Y Acceleration") + geom_point(data=feat, aes(x = X, y=fY, group=2,color = 'Falls'))
p3<-ggplot(data=Falls_df, aes(x = time, y=accZ, group=1)) +
  geom_line(linetype = "solid") + labs(title = "Z Acceleration") + geom_point(data=feat, aes(x = X, y=fZ, group=2,color = 'Falls'))

p1/p2/p3
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
